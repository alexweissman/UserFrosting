{% extends "pages/abstract/fk-base.html.twig" %}
{% block page_title %}Make Pick
				{% endblock %}
{% block content %}

	<section class="mx-auto w-full">
		<div class="justify-between mx-auto max-w-7xl mt-12 space-y-6 ">
			<div class="flex w-full justify-between items-center align-center xl:px-0 px-5">
				<h1 class="text-[#331E36] font-semibold text-4xl tracking-tight" style="font-family: 'MangueiraSemiBold';">Make Your Pick:
					{{league.league_name}}</h1>
				<div class="space-x-2">
					<a href="{{site.uri.public}}/leagues">
						<button class="px-4 py-2 rounded-md border border-[#331E36] text-[#331E36] text-sm font-semibold uppercase tracking-wider">Back</button>
					</a>
				</div>
			</div>
			<div id="alerts"></div>
			<div class="flex flex-wrap w-full xl:px-0 px-5">
				<form class="space-y-3 w-full" method="POST" action="{{site.uri.public}}/pick/new/{{league.id}}">
					{% include "forms/csrf.html.twig" %}
					<input value="{{currentPick.team_id}}" type="hidden" name="pickedTeam" id="pickedTeam"/>
					<div class="w-full flex flex-wrap">
					{% for f in fixtures %}
						<div class="flex w-full lg:w-1/3 mt-2 mx-2">
						<!-- Home Team -->
							{% set homePicked = false %}
							{% for pick in previousPicks %}
								{% if pick.team_id == f.home_team %}
									{% set homePicked = true %} 
								{% endif %}
							{% endfor %}
							{% if homePicked == '1'  %}
								<div class="rounded-tl-lg rounded-bl-lg cursor-pointer border-2 border-t-2 border-l-2 border-b-2
									flex flex-col align-center items-center w-1/2 text-center bg-slate-200" id="pick-{{f.home_team}}" disabled>
									{% for team in teams %}
										{% if team.id == f.home_team %}
											<div class="p-2 bg-slate-200">
												<img src="https://res.cloudinary.com/dvxfsaa5t/image/upload/f_auto,q_auto/v1/FootballKnockout/{{team.image_name}}" class="h-10 w-10">
											</div>
											<div class="text-center w-full bg-slate-200 px-4 py-1 rounded-bl-lg">
												{{ team.team_name}}
											</div>
										{% endif %}
									{% endfor %}
								</div>
							{% else %}
								<div class="rounded-tl-lg rounded-bl-lg  border-2 border-t-2 border-l-2 border-b-2
									{% if f.home_team == currentPick.team_id %}
											border-[#331E36]
										{% else %}
											border-slate-200
										{% endif %}
									flex flex-col align-center items-center w-1/2 text-center" id="pick-{{f.home_team}}" onclick="chooseTeam({{f.home_team}})">
									{% for team in teams %}
										{% if team.id == f.home_team %}
											<div class="p-2">
												<img src="https://res.cloudinary.com/dvxfsaa5t/image/upload/f_auto,q_auto/v1/FootballKnockout/{{team.image_name}}" class="h-10 w-10">
											</div>
											<div class="text-center w-full bg-slate-200 px-4 py-1 rounded-bl-lg">
												{{ team.team_name}}
											</div>
										{% endif %}
									{% endfor %}
								</div>
							{% endif %}
						<!-- End Home Team -->
						<!-- Away Team -->
						{% set awayPicked = false %}
						{% for pick in previousPicks %}
							{% if pick.team_id == f.away_team %}
								{% set awayPicked = true %}
							{% endif %}
						{% endfor %}
						{% if awayPicked == true %}
							<div class="rounded-tr-lg rounded-br-lg  border-2 border-t-2 border-r-2 border-b-2 cursor-pointer
								flex flex-col align-center items-center w-1/2 text-center bg-slate-200" id="pick-{{f.away_team}}" >
								{% for team in teams %}
									{% if team.id == f.away_team %}
										<div class="p-2">
											<img src="https://res.cloudinary.com/dvxfsaa5t/image/upload/f_auto,q_auto/v1/FootballKnockout/{{team.image_name}}" class="h-10 w-10 bg-slate-200">
										</div>
										<div class="text-center w-full bg-slate-200 px-4 py-1 rounded-br-lg">
											{{ team.team_name}}
										</div>
									{% endif %}
								{% endfor %}
							</div>
						{% else %}
							<div class="rounded-tr-lg rounded-br-lg  border-2 border-t-2 border-r-2 border-b-2
								{% if f.away_team == currentPick.team_id %}
										border-[#331E36]
									{% else %}
										border-slate-200
									{% endif %}
								flex flex-col align-center items-center w-1/2 text-center " id="pick-{{f.away_team}}" onclick="chooseTeam({{f.away_team}})">
								{% for team in teams %}
									{% if team.id == f.away_team %}
										<div class="p-2">
											<img src="https://res.cloudinary.com/dvxfsaa5t/image/upload/f_auto,q_auto/v1/FootballKnockout/{{team.image_name}}" class="h-10 w-10">
										</div>
										<div class="text-center w-full bg-slate-200 px-4 py-1 rounded-br-lg">
											{{ team.team_name}}
										</div>
									{% endif %}
								{% endfor %}
							</div>
						{% endif %}
						<!-- End Away Team -->
						</div>
					{% endfor %}
					</div>
					<button class="px-4 ml-2 py-2 rounded-md bg-[#331E36]  border border-[#331E36] text-white text-sm font-semibold uppercase tracking-wider w-full md:w-auto">
						<p>Confirm Pick</p>
					</button>
				</form>
			</div>	
			<script
				type="module"
				src="https://widgets.api-sports.io/2.0.3/widgets.js">
			</script>
			<script>
				function chooseTeam(teamId) { // set all other divs to normal border
					for (let i = 21; i < 41; i++) { // doesn't work because team IDs aren't 1-20
					document.getElementById('pick-' + i).classList.add('border-slate-200');
					document.getElementById('pick-' + i).classList.remove('border-[#331E36]');
					}
					// set selected div to new border
					document.getElementById('pick-' + teamId).classList.toggle('border-[#331E36]');
					document.getElementById('pick-' + teamId).classList.toggle('border-slate-200');

					// add teamId value to hidden field
					document.getElementById('pickedTeam').value = teamId;
				}
			</script>
		</section>
	{% endblock %}
